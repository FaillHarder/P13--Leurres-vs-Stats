{% extends 'base.html' %}
{% load static %}
{% block title %}Search - {% endblock title %}
{% block content %}
<div class="container">
    <div class="container">
        <div class="title m-5">
            <h5>Tu as envie de gagner du temps, tu es sur le point de pécher et tu veux connaitre le top3 des meilleurs leurres et couleurs?</h5>
            Renseigne le formulaire est laisse la magie opérer
        </div>
    </div>
    
    <div class="container logform">
        <form method="POST">
            {% csrf_token %}
            <div class="title">
                Le Top 3
            </div>
            <div class="form-group">
                <label class="text-white" for="skystate">Etat du ciel</label>
                {{ form.skystate}}
            </div>
            <div class="form-group">
                <label class="text-white" for="waterstate">Etat de l'eau</label>
                {{ form.waterstate }}
            </div>
            <button type="submit" class="btn btn-primary" id="top3-submit">Valider</button>
        </form>

    </div>
</div>
<!-- <script>
    const top3Submit = document.getElementById('top3-submit')

    // requete ajax
    async function ajaxRequest(url, data, csrftoken) {
        let requestData = await fetch(url, {
            method: "POST",
            body: data,
            headers: {
                'X-CSRFToken': csrftoken
            }
        });
        let jsonData = await requestData.json()
        return jsonData
    }

    top3Submit.addEventListener('click', async function(e) {
        e.preventDefault();
        let formData = new FormData();
        let csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;
        let skystate = document.getElementById("id_skystate");
        let waterstate = document.getElementById("id_waterstate");
        

        formData.append("skystate", skystate.value);
        formData.append("waterstate", waterstate.value);

        let result = await ajaxRequest("{% url 'search' %}", formData, csrfToken);
        console.log(result["result"][0])
        console.log(result["result"][1])

    })
</script> -->
{% endblock content %}
